# Preliminary Data Understanding Report

Date: 2025-07-04
Agent: data_understanding_agent

## 1. Data Overview
- Source: `/root/data/nobil-realtime_datadump/`
- Structure: Nested directories by year/month/day/hour/minute containing Avro files (e.g., `2024/06/16/10/27/45.avro`).
- Total Avro files in sample area: ~13,101 (entire dump).
- Each Avro file represents a snapshot (stream batch) of charging point status messages at a specific timestamp.

## 2. Schema & Key Fields (Sample)
- Avro container schema fields:
  - `SequenceNumber` (long)
  - `Offset` (string)
  - `EnqueuedTimeUtc` (string)
  - `SystemProperties` (map)
  - `Properties` (map, sometimes empty)
  - `Body` (bytes) – contains JSON payload, with fields:
    - `nobilId` (string): station identifier (e.g., "NOR_13790").
    - `evseUId` (string): charging point (EVSE) identifier.
    - `status` (string): one of {`AVAILABLE`, `CHARGING`, `OUTOFORDER`, `UNKNOWN`, `BLOCKED`, `RESERVED`}.
    - `timestamp` (ISO 8601 string): event time (UTC).
    - `process_id` (string): message producer ID.

## 3. Sample Statistics (50 Avro files)
- Files sampled: 50
- Total records: 114,660
- Unique station IDs: 3,739
- Unique EVSE IDs: 13,229

### Status Distribution (sample)
- AVAILABLE: 54,316 (47.4%)
- CHARGING: 32,736 (28.6%)
- OUTOFORDER: 12,546 (10.9%)
- UNKNOWN: 12,239 (10.7%)
- BLOCKED: 2,822 (2.5%)
- RESERVED: 1 (<0.01%)

### Snapshot Size (records per file)
- Minimum: 655
- Maximum: 3,737
- Average: 2,293

## 4. Data Quality & Processing Considerations
- **Message Body Parsing**: `Body` field is raw bytes containing JSON; must decode and parse for tabular ingestion.
- **Timestamp Handling**: `timestamp` field is ISO 8601 with offset; convert to datetime with timezone awareness.
- **Field Completeness**: Sample indicated all expected fields present; further checks needed on larger walk.
- **Status Values**: Rare statuses (`RESERVED`) may be dropped or consolidated if insignificant.
- **Sampling Bias**: Current statistics are for a small sample; global distribution may vary.

## 5. Initial Insights & Hypotheses
- EVSE usage snapshot sizes vary by hour; peak snapshot records (~3.7k) may indicate higher traffic periods.
- Approximately 28.6% of messages are `CHARGING`, suggesting average occupancy; `AVAILABLE` ~47%.
- `OUTOFORDER` constitutes ~11% of sample messages; reliability concerns worth further quantification.

## 6. Next Steps
1. **Full Ingestion Pipeline**:
   - Recursively traverse Avro files, decode JSON `Body`, and append to a unified DataFrame or Parquet store.
   - Persist standardized columns: `nobilId`, `evseUId`, `status`, `timestamp`, plus file snapshot metadata (e.g., snapshot time).
2. **Data Cleaning**:
   - Uniform datetime parsing (UTC), handle missing or null values.
   - De-duplicate repeated messages at same timestamp if needed.
3. **Exploratory Analysis**:
   - Compute time-series of occupancy per station/EVSE.
   - Identify peak demand hours and utilization trends.
   - Quantify capacity pressure (hours with occupancy ≥ 90%).
   - Assess downtime/duration of prolonged `OUTOFORDER` status.
4. **Collaboration**:
   - Confirm definitions and thresholds with business agent (e.g., treatment of `UNKNOWN`).
   - Align on granularity (hourly snapshots) and expected date range coverage.

*Report generated by data_understanding_agent.*